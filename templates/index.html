<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a2e0f2ac1f.js" crossorigin="anonymous"></script>
</head>
<body>

  <!-- SVG Hintergrund -->
  <svg class="bcg" preserveAspectRatio="xMidYMid slice" viewBox="10 10 80 80">
    <defs>
      <style>
        @keyframes rotate {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        .out-top { animation: rotate 20s linear infinite; transform-origin: 13px 25px; }
        .in-top { animation: rotate 10s linear infinite; transform-origin: 13px 25px; }
        .out-bottom { animation: rotate 25s linear infinite; transform-origin: 84px 93px; }
        .in-bottom { animation: rotate 15s linear infinite; transform-origin: 84px 93px; }
      </style>
    </defs>
    <path fill="#f780600f" class="out-top" d="M37-5C25.1-14.7,5.7-19.1-9.2-10-28.5,1.8-32.7,31.1-19.8,49c15.5,21.5,52.6,22,67.2,2.3C59.4,35,53.7,8.5,37-5Z"/>
    <path fill="#f780600f" class="in-top" d="M20.6,4.1C11.6,1.5-1.9,2.5-8,11.2-16.3,23.1-8.2,45.6,7.4,50S42.1,38.9,41,24.5C40.2,14.1,29.4,6.6,20.6,4.1Z"/>
    <path fill="#f780600f" class="out-bottom" d="M105.9,48.6c-12.4-8.2-29.3-4.8-39.4,0.8-23.4,12.8-37.7,51.9-19.1,74.1s63.9,15.3,76-5.6c7.6-13.3,1.8-31.1-2.3-43.8C117.6,63.3,114.7,54.3,105.9,48.6Z"/>
    <path fill="#f780600f" class="in-bottom" d="M102,67.1c-9.6-6.1-22-3.1-29.5,2-15.4,10.7-19.6,37.5-7.6,47.8s35.9,3.9,44.5-12.5C115.5,92.6,113.9,74.6,102,67.1Z"/>
  </svg>

  <div class="dashboard-layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo">
        <img src="https://helpcare.de/wp-content/uploads/2025/07/path1.png" alt="Logo">
      </div>
      <div class="profile">
        <span>Ole</span>
        <img src="https://helpcare.de/wp-content/uploads/2025/08/2025-07-17_HelpCare-Gruppenfoto_027_lores.jpeg" alt="Profil" />
      </div>
      <ul class="nav">
        <li class="active"><i class="fas fa-home"></i> Dashboard</li>
        <li><i class="fas fa-calendar-alt"></i> Kalendar</li>
        <li><i class="fas fa-life-ring"></i> Hilfe</li>
      </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <div class="topbar">
        <h1>Dashboard</h1>
        <div style="text-align: right;">
          <h1>{{ aktuelles_datum }}</h1>
          <p id="liveClock" style="font-size: 1rem; color: #666;"></p>
        </div>
      </div>

      <!-- KPI Cards -->
      <section class="kpis">
        <div class="kpi-card"><h4>Anfragen</h4><p>23</p></div>
        <div class="kpi-card"><h4>Eins√§tze</h4><p>70</p></div>
        <div class="kpi-card"><h4>Betreuungskr√§fte</h4><p>500</p></div>
      </section>
    

      <!-- Middle Content -->
       <div class="upcoming-meetings">
        <h3>Eins√§tze</h3>
        <div id="einsatzList">
          <p>Lade Eins√§tze...</p>
        </div>
      </div>
      <section class="middle-row">
        <div class="kpi-score">
          <h3>Nachrichten</h3>
          <p class="score">63.89%</p>
          <p class="change">-2.34%</p>
        </div>

        <div class="top-performance">
            <h3>Notizen</h3>
            <textarea id="notizenEditor" placeholder="Schreibe dir eine Notiz..."></textarea>
            <button id="saveNote">Speichern</button>
        </div>

      </section>

      <!-- Gmail Bereich -->
      <section class="working-format">
        <h3>Gmail</h3>
        <ul id="email-list">
          <li>Lade E-Mails...</li>
        </ul>
      </section>
    </main>
  </div>
  
  <!-- Notepad -->
    <script>
        const editor = document.getElementById("notizenEditor");
        const button = document.getElementById("saveNote");

        // Notiz laden
        editor.value = localStorage.getItem("notiz") || "";

        button.onclick = () => {
            localStorage.setItem("notiz", editor.value);
            alert("‚úÖ Notiz gespeichert!");
        };
    </script>

  <!-- Uhrzeit -->
  <script>
    function updateClock() {
      const now = new Date();
      const options = {
        weekday: 'long',
        day: '2-digit',
        month: 'long',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      };
      const formatted = now.toLocaleString('de-DE', options).replace(',', ' ‚Äì');
      document.getElementById("liveClock").textContent = formatted;
    }
    updateClock();
    setInterval(updateClock, 1000);
  </script>

  <!-- Eins√§tze laden -->
  <script>
    async function loadEinsaetze() {
      const res = await fetch("/api/get-anfragen");
      const data = await res.json();
      const list = document.getElementById("einsatzList");
      list.innerHTML = "";

      data.forEach(item => {
        const card = document.createElement("div");
        card.className = "meeting-card";
        card.innerHTML = `
          <strong>${item.name}</strong><br>
          <small>üìû ${item.tel}</small>
        `;
        list.appendChild(card);
      });
    }
    loadEinsaetze();
  </script>

  <!-- Gmail laden -->
  <script>
    fetch("/api/emails")
      .then(res => res.json())
      .then(data => {
        const list = document.getElementById("email-list");
        list.innerHTML = "";
        data.forEach(mail => {
          const li = document.createElement("li");
          const link = document.createElement("a");
          link.href = "https://mail.google.com/mail/u/0/#inbox";
          link.target = "_blank";
          link.innerHTML = `<strong>${mail.from}</strong><br>${mail.subject}<br><small>${mail.time}</small>`;
          li.appendChild(link);
          list.appendChild(li);
        });
      })
      .catch(() => {
        document.getElementById("email-list").innerHTML = "<li>‚ùå Fehler beim Laden</li>";
      });
  </script>
</body>
</html>
